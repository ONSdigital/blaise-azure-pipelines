---
parameters:
  - name: TestSolutionName
    displayName: Test solution name
  - name: ArtifactName
    displayName: Artifact name
  - name: TestName
    displayName: Test name
steps:
  - task: VisualStudioTestPlatformInstaller@1
    displayName: Install Visual Studio test platform
    inputs:
      packageFeedSelector: nugetOrg
      versionSelector: latestPreRelease
  - task: VSTest@2
    displayName: Run tests
    inputs:
      searchFolder: $(System.ArtifactsDirectory)
      testAssemblyVer2: |
        **\${{parameters.TestSolutionName}}\**\${{parameters.TestSolutionName}}.dll
        !**\obj\**
      resultsFolder: '$(System.DefaultWorkingDirectory)\TestResults'
      otherConsoleOptions: /stopOnError
      runOnlyImpactedTests: false
      uiTests: true
      vsTestVersion: toolsInstaller
      runInParallel: false
      runTestsInIsolation: false
      codeCoverageEnabled: false
      testRunTitle: ${{parameters.TestName}}
    continueOnError: false
