---
parameters:
  - name: SYSTEM_ACCESSTOKEN
    displayName: Access token for WIF authentication
    type: string

steps:
  - task: PowerShell@2
    env:
      SYSTEM_ACCESSTOKEN: $(System.AccessToken)
    displayName: Download test questionnaire
    inputs:
      targetType: filePath
      filePath: $(Agent.BuildDirectory)/s/scripts/download_files_from_shared_bucket.ps1
      arguments: >-
        -SystemAccessToken "$env:SYSTEM_ACCESSTOKEN"
        -SharedServiceAccount "$(ENV_SHARED_SERVICE_ACCOUNT)"
        -SharedBucket "$(ENV_SHARED_BUCKET)"
        -FileName "$(QuestionnaireName).bpkg"
        -DestinationPath "c:\survey\$(QuestionnaireName).bpkg"