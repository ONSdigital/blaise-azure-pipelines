---
parameters:
  - name: SYSTEM_ACCESSTOKEN
    type: string
  - name: Project
    type: string
    default: "ons-blaise-v2-shared"

steps:
  - task: PowerShell@2
    env:
      SYSTEM_ACCESSTOKEN: ${{ parameters.SYSTEM_ACCESSTOKEN }}
    displayName: Download test questionnaire
    inputs:
      targetType: filePath
      filePath: $(Agent.BuildDirectory)/s/scripts/download_files_from_shared_bucket.ps1
      arguments: >-
        -SystemAccessToken "$env:SYSTEM_ACCESSTOKEN"
        -SharedServiceAccount "$(ENV_SHARED_SERVICE_ACCOUNT)"
        -SharedBucket "$(ENV_SHARED_BUCKET)"
        -FileName "$(QuestionnaireName).bpkg"
        -DestinationPath "c:\survey\$(QuestionnaireName).bpkg"
        -Project "${{ parameters.Project }}"